<!DOCTYPE Robei>
<Module Height="600" Name="uart_16550_tb" Include="uart_def.v,sfifo_def.v" File="Current/uart_16550_tb.test" Time_Scale="" Comment="" Color="#d3d3d3" X="0" Width="900" Class="module" Y="0" Type="testbench" Code="initial begin&#xa;  clk = 0;&#xa;end&#xa;always #42 clk = ~clk;    // The FPGA crystal oscillator is 12MHz, which means the clock cycle is 84ns&#xa;&#xa;initial begin&#xa;  rst_n = 1;&#xa;  repeat(1) @( posedge clk ) #1;&#xa;  rst_n = 0;&#xa;  repeat(1) @( posedge clk ) #1;&#xa;  rst_n = 1;&#xa;end&#xa;&#xa;initial begin&#xa;  data_in = 0;&#xa;  write_n = 1;&#xa;  parity  = 3'b001; // Odd check&#xa;  stop_bit = 1; &#xa;  data_bit = 8;&#xa;  baud_rate = 9600;&#xa;  rx = 1;&#xa;  read_n = 1;&#xa;&#xa;  //&#xa;  // Test CPU send data to fifo&#xa;  repeat( 5 ) @( posedge clk ) #1;&#xa;  write_n = 0;&#xa;  data_in = 8'b 1000_0001; &#xa;  repeat( 80 ) @( posedge clk ) #1;&#xa;  write_n = 1;&#xa;  repeat( 10 ) @( posedge clk ) #1;&#xa;  repeat( 78*200 ) @( posedge clk ) #1;&#xa;&#xa;  //&#xa;  // Test slave devices send data to CPU&#xa;  //&#xa;  // Receive data 8'0_1000_0011, odd check bit is 0, data_bit is 8&#xa;  //&#xa;  rx=1;&#xa;  repeat(32)@( posedge clk ) #1;&#xa;  rx = 0;  // Start signal&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;  // Least significant signal&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;  // Most significant signal&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;  // Parity check&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;  // Stop bit   &#xa;  repeat(200*78)@( posedge clk ) #1;&#xa;  read_n = 0;&#xa;  repeat( 78 ) @( posedge clk ) #1;&#xa;  read_n = 1;&#xa;  repeat( 78*200 ) @( posedge clk ) #1;&#xa;&#xa;  // Receive data 8'1_1001_0011, odd check bit is 0, data_bit is 8&#xa;  //&#xa;  rx=1;&#xa;  repeat(32)@( posedge clk ) #1;&#xa;  rx = 0;  // Start signal&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;  // Least significant signal&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;  // Most significant signal&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;  // Parity check&#xa;  repeat(16*78)@( posedge clk ) #1;&#xa;  rx = 1;  // Stop bit   &#xa;  repeat(200*78)@( posedge clk ) #1;&#xa;  read_n = 0;&#xa;  repeat( 78 ) @( posedge clk ) #1;&#xa;  read_n = 1;&#xa;  repeat( 78*200 ) @( posedge clk ) #1;&#xa;  $finish;  &#xa;&#xa;end&#xa;&#xa;&#xa;   &#xa;&#xa;&#xa;" Parent="0">
 <Module Height="382" Name="uart_165501" Parameters="" Include="uart_def.v,sfifo_def.v" File="Current/uart_16550.model" Comment="" Color="#d3d3d3" X="330.401" Width="269" Class="uart_16550" Y="128.868" Type="model" Code="reg tx_request;&#xa;&#xa;always @( posedge generate_clk1_clk_out or negedge rst_n ) begin&#xa;  if( ~rst_n ) begin&#xa;    tx_request &lt;= #`DEL 1'b0;&#xa;  end&#xa;  else begin&#xa;    case( { tx_buf_full, empty } ) &#xa;      2'b00: begin&#xa;        tx_request &lt;= #`DEL 1'b1;&#xa;      end&#xa;      2'b01: begin&#xa;        tx_request &lt;= #`DEL 1'b0;&#xa;      end&#xa;      2'b10: begin&#xa;        tx_request &lt;= #`DEL 1'b0;&#xa;      end&#xa;      2'b11: begin&#xa;        tx_request &lt;= #`DEL 1'b0;&#xa;      end&#xa;    endcase&#xa;  end&#xa;end      &#xa;&#xa;assign write_en = ~rx_done;&#xa;&#xa;&#xa;" Parent="uart_16550_tb">
  <Port Height="20" Name="clk" Connect="" Side="left" Color="#0000ff" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.136126" Inout="input" Parent="uart_165501"/>
  <Port Height="20" Name="rst_n" Connect="" Side="left" Color="#00ffff" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.298429" Inout="input" Parent="uart_165501"/>
  <Port Height="20" Name="data_in" Connect="" Side="left" Color="#7fffd4" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="8" Y="0.460733" Inout="input" Parent="uart_165501"/>
  <Port Height="20" Name="write_n" Connect="" Side="left" Color="#8a2be2" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.541885" Inout="input" Parent="uart_165501"/>
  <Port Height="20" Name="parity" Connect="" Side="left" Color="#5f9ea0" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="3" Y="0.623037" Inout="input" Parent="uart_165501"/>
  <Port Height="20" Name="stop_bit" Connect="" Side="left" Color="#ffe4c4" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="2" Y="0.704188" Inout="input" Parent="uart_165501"/>
  <Port Height="20" Name="data_bit" Connect="" Side="left" Color="#b8860b" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="4" Y="0.78534" Inout="input" Parent="uart_165501"/>
  <Port Height="20" Name="baud_rate" Connect="" Side="left" Color="#ffebcd" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="19" Y="0.379581" Inout="input" Parent="uart_165501"/>
  <Port Height="20" Name="tx" Connect="" Side="right" Color="#0000ff" X="0.925651" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.219895" Inout="output" Parent="uart_165501"/>
  <Port Height="20" Name="tx_buf_full" Connect="" Side="right" Color="#8a2be2" X="0.925651" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.0968586" Inout="output" Parent="uart_165501"/>
  <Port Height="20" Name="rx" Connect="" Side="left" Color="#a52a2a" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.0549738" Inout="input" Parent="uart_165501"/>
  <Port Height="20" Name="data_out" Connect="" Side="right" Color="#deb887" X="0.925651" Width="20" Function="" Datatype="wire" Datasize="8" Y="0.712042" Inout="output" Parent="uart_165501"/>
  <Port Height="20" Name="empty" Connect="" Side="right" Color="#5f9ea0" X="0.925651" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.342932" Inout="output" Parent="uart_165501"/>
  <Port Height="20" Name="full" Connect="" Side="right" Color="#7fff00" X="0.925651" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.589005" Inout="output" Parent="uart_165501"/>
  <Port Height="20" Name="half_full" Connect="" Side="right" Color="#d2691e" X="0.925651" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.465969" Inout="output" Parent="uart_165501"/>
  <Port Height="20" Name="read_n" Connect="" Side="left" Color="#ff7f50" X="-0.0743494" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.217277" Inout="input" Parent="uart_165501"/>
 </Module>
 <Port Height="20" Name="clk" Side="left" Color="#0000ff" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="1" Y="0.0666667" Inout="input" Parent="uart_16550_tb"/>
 <Port Height="20" Name="rst_n" Side="left" Color="#00ffff" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="1" Y="0.15" Inout="input" Parent="uart_16550_tb"/>
 <Port Height="20" Name="data_in" Side="left" Color="#7fffd4" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="8" Y="0.566667" Inout="input" Parent="uart_16550_tb"/>
 <Port Height="20" Name="write_n" Side="left" Color="#8a2be2" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="1" Y="0.65" Inout="input" Parent="uart_16550_tb"/>
 <Port Height="20" Name="parity" Side="left" Color="#5f9ea0" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="3" Y="0.233333" Inout="input" Parent="uart_16550_tb"/>
 <Port Height="20" Name="stop_bit" Side="left" Color="#ffe4c4" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="2" Y="0.316667" Inout="input" Parent="uart_16550_tb"/>
 <Port Height="20" Name="data_bit" Side="left" Color="#b8860b" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="4" Y="0.4" Inout="input" Parent="uart_16550_tb"/>
 <Port Height="20" Name="baud_rate" Side="left" Color="#ffebcd" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="19" Y="0.483333" Inout="input" Parent="uart_16550_tb"/>
 <Port Height="20" Name="tx" Side="right" Color="#0000ff" X="0.977778" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.233333" Inout="output" Parent="uart_16550_tb"/>
 <Port Height="20" Name="tx_buf_full" Side="right" Color="#8a2be2" X="0.977778" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.108333" Inout="output" Parent="uart_16550_tb"/>
 <Port Height="20" Name="rx" Side="left" Color="#a52a2a" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="1" Y="0.733333" Inout="input" Parent="uart_16550_tb"/>
 <Port Height="20" Name="data_out" Side="right" Color="#deb887" X="0.977778" Width="20" Function="" Datatype="wire" Datasize="8" Y="0.358333" Inout="output" Parent="uart_16550_tb"/>
 <Port Height="20" Name="empty" Side="right" Color="#5f9ea0" X="0.977778" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.483333" Inout="output" Parent="uart_16550_tb"/>
 <Port Height="20" Name="full" Side="right" Color="#7fff00" X="0.977778" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.608333" Inout="output" Parent="uart_16550_tb"/>
 <Port Height="20" Name="half_full" Side="right" Color="#d2691e" X="0.977778" Width="20" Function="" Datatype="wire" Datasize="1" Y="0.733333" Inout="output" Parent="uart_16550_tb"/>
 <Port Height="20" Name="read_n" Side="left" Color="#ff7f50" X="-0.0222222" Width="20" Function="" Datatype="reg" Datasize="1" Y="0.816667" Inout="input" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>clk" Name="uart_16550_tb_clk" Datatype="wire" Datasize="1" To="uart_16550_tb#uart_165501>clk" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>rx" Name="uart_16550_tb_rx" Datatype="wire" Datasize="1" To="uart_16550_tb#uart_165501>rx" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>rst_n" Name="uart_16550_tb_rst_n" Datatype="wire" Datasize="1" To="uart_16550_tb#uart_165501>rst_n" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>write_n" Name="uart_16550_tb_write_n" Datatype="wire" Datasize="1" To="uart_16550_tb#uart_165501>write_n" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>parity" Name="uart_16550_tb_parity" Datatype="wire" Datasize="3" To="uart_16550_tb#uart_165501>parity" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>stop_bit" Name="uart_16550_tb_stop_bit" Datatype="wire" Datasize="2" To="uart_16550_tb#uart_165501>stop_bit" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>data_bit" Name="uart_16550_tb_data_bit" Datatype="wire" Datasize="4" To="uart_16550_tb#uart_165501>data_bit" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>baud_rate" Name="uart_16550_tb_baud_rate" Datatype="wire" Datasize="19" To="uart_16550_tb#uart_165501>baud_rate" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>read_n" Name="uart_16550_tb_read_n" Datatype="wire" Datasize="1" To="uart_16550_tb#uart_165501>read_n" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb#uart_165501>tx_buf_full" Name="uart_165501_tx_buf_full" Datatype="wire" Datasize="1" To="uart_16550_tb>tx_buf_full" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb#uart_165501>tx" Name="uart_165501_tx" Datatype="wire" Datasize="1" To="uart_16550_tb>tx" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb#uart_165501>half_full" Name="uart_165501_half_full" Datatype="wire" Datasize="1" To="uart_16550_tb>half_full" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb#uart_165501>empty" Name="uart_165501_empty" Datatype="wire" Datasize="1" To="uart_16550_tb>empty" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb#uart_165501>full" Name="uart_165501_full" Datatype="wire" Datasize="1" To="uart_16550_tb>full" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb#uart_165501>data_out" Name="uart_165501_data_out" Datatype="wire" Datasize="8" To="uart_16550_tb>data_out" Parent="uart_16550_tb"/>
 <Wire From="uart_16550_tb>data_in" Name="uart_16550_tb_data_in" Datatype="wire" Datasize="8" To="uart_16550_tb#uart_165501>data_in" Parent="uart_16550_tb"/>
</Module>
