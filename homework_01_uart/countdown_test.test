<!DOCTYPE Robei>
<Module Code="//&#xa;// Generate clock&#xa;//&#xa;initial begin&#xa;  clk = 0;&#xa;end&#xa;always #10 clk = ~clk;&#xa;&#xa;//&#xa;// Generate reset signal&#xa;//&#xa;initial begin&#xa;  rst_n = 1;&#xa;  repeat(1) @( posedge clk ) #1;&#xa;  rst_n = 0;&#xa;  repeat(1) @( posedge clk ) #1;&#xa;  rst_n = 1;&#xa;end&#xa;&#xa;//&#xa;// Generate input signal &#xa;//&#xa;initial begin &#xa;  count_en = 0;&#xa;  tx_done  = 0;&#xa;  repeat( 4 ) @( posedge clk ) #1;&#xa;  count_en = 1;&#xa;  repeat( 2 ) @( posedge clk ) #1;&#xa;  count_en = 0;&#xa;  repeat( 5 ) @( posedge clk ) #1;&#xa;  tx_done  = 1;&#xa;  repeat( 1 ) @( posedge clk ) #1;&#xa;  tx_done  = 0;&#xa;  repeat( 16 ) @( posedge clk ) #1;&#xa;  tx_done  = 1;&#xa;  repeat( 1 ) @( posedge clk ) #1;&#xa;  tx_done  = 0;&#xa;  repeat( 16 ) @( posedge clk ) #1;&#xa;  tx_done  = 1;&#xa;  repeat( 1 ) @( posedge clk ) #1;&#xa;  tx_done  = 0;&#xa;  repeat( 2 ) @( posedge clk ) #1;&#xa;  repeat( 4 ) @( posedge clk ) #1;&#xa;  count_en = 1;&#xa;  repeat( 2 ) @( posedge clk ) #1;&#xa;  count_en = 0;&#xa;  repeat( 16 ) @( posedge clk ) #1;&#xa;  $finish;&#xa;end" X="0" Name="countdown_test" Class="module" Time_Scale="" Width="900" Include="" Parent="0" Comment="" Color="#d3d3d3" Height="600" Y="0" File="Current/countdown_test.test" Type="testbench">
 <Module Code="`define DEL 1&#xa;&#xa;//&#xa;// Count enable edge detected&#xa;//&#xa;reg     count_en_q;&#xa;wire    count_en_flag;&#xa;&#xa;always @( posedge clk or negedge rst_n ) begin&#xa;  if( ~rst_n ) begin&#xa;    count_en_q &lt;= #`DEL 1'b0;&#xa;  end&#xa;  else begin&#xa;    count_en_q &lt;= #`DEL count_en;&#xa;  end&#xa;end&#xa;assign count_en_flag = ~count_en_q &amp;&amp; ( count_en );&#xa;&#xa;//&#xa;// Tx_done edge detected&#xa;// Tx_done signal comes from uart unit, while uart transmit one data done, begining next count &#xa;//&#xa;reg     tx_done_q;&#xa;wire    tx_done_n;&#xa;wire    tx_done_flag;&#xa;&#xa;always @( posedge clk or negedge rst_n ) begin&#xa;  if( ~rst_n ) begin&#xa;    tx_done_q &lt;= #`DEL 1'b0;&#xa;  end&#xa;  else begin&#xa;    tx_done_q &lt;= #`DEL tx_done_n;&#xa;  end&#xa;end&#xa;assign tx_done_n = ~tx_done;&#xa;assign tx_done_flag = ~tx_done_q &amp;&amp; ( tx_done_n );&#xa;&#xa;//&#xa;// Countdown and output&#xa;//&#xa;reg [7:0] count;&#xa;   &#xa;&#xa;always @( posedge clk or negedge rst_n ) begin&#xa;  if( ~rst_n ) begin&#xa;    count      &lt;= #`DEL 8'd0;&#xa;    count_full &lt;= #`DEL 1'b0;&#xa;  end&#xa;  else if( count_en_flag ) begin&#xa;    count      &lt;= #`DEL 8'd0;&#xa;    count_full &lt;= #`DEL 1'b1;&#xa;  end&#xa;  else if( tx_done_flag ) begin&#xa;    if( count == 8'd99 )begin&#xa;      count &lt;= #`DEL 8'd0;&#xa;      count_full &lt;= #`DEL 1'b0;&#xa;    end&#xa;    else begin&#xa;      count      &lt;= #`DEL count + 1;&#xa;      count_full &lt;= #`DEL 1'b1;&#xa;    end&#xa;  end&#xa;  else begin&#xa;    count      &lt;= #`DEL count;&#xa;    count_full &lt;= #`DEL 1'b0;&#xa;  end&#xa;end&#xa;&#xa;assign count_out  =  count;" X="340.458" Name="countdown1" Class="countdown" Parameters="" Width="161" Include="" Parent="countdown_test" Comment="" Color="#d3d3d3" Height="162" Y="199.389" File="Current/countdown.model" Type="model">
  <Port Datasize="1" Function="" X="-0.124224" Name="clk" Inout="input" Width="20" Connect="" Parent="countdown1" Color="#0000ff" Height="20" Y="0.0987654" Side="left" Datatype="wire"/>
  <Port Datasize="1" Function="" X="-0.124224" Name="rst_n" Inout="input" Width="20" Connect="" Parent="countdown1" Color="#00ffff" Height="20" Y="0.271605" Side="left" Datatype="wire"/>
  <Port Datasize="1" Function="" X="-0.124224" Name="count_en" Inout="input" Width="20" Connect="" Parent="countdown1" Color="#8a2be2" Height="20" Y="0.438272" Side="left" Datatype="wire"/>
  <Port Datasize="1" Function="" X="0.875776" Name="count_full" Inout="output" Width="20" Connect="" Parent="countdown1" Color="#a52a2a" Height="20" Y="0.179012" Side="right" Datatype="reg"/>
  <Port Datasize="8" Function="" X="0.875776" Name="count_out" Inout="output" Width="20" Connect="" Parent="countdown1" Color="#7fff00" Height="20" Y="0.432099" Side="right" Datatype="wire"/>
  <Port Datasize="1" Function="" X="-0.124224" Name="tx_done" Inout="input" Width="20" Connect="" Parent="countdown1" Color="#d2691e" Height="20" Y="0.598765" Side="left" Datatype="wire"/>
 </Module>
 <Port Datasize="1" Function="" X="-0.0222222" Name="clk" Inout="input" Width="20" Parent="countdown_test" Color="#0000ff" Height="20" Y="0.15" Side="left" Datatype="reg"/>
 <Port Datasize="1" Function="" X="-0.0222222" Name="rst_n" Inout="input" Width="20" Parent="countdown_test" Color="#00ffff" Height="20" Y="0.316667" Side="left" Datatype="reg"/>
 <Port Datasize="1" Function="" X="-0.0222222" Name="count_en" Inout="input" Width="20" Parent="countdown_test" Color="#8a2be2" Height="20" Y="0.481667" Side="left" Datatype="reg"/>
 <Port Datasize="1" Function="" X="0.977778" Name="count_full" Inout="output" Width="20" Parent="countdown_test" Color="#a52a2a" Height="20" Y="0.231667" Side="right" Datatype="wire"/>
 <Port Datasize="8" Function="" X="0.977778" Name="count_out" Inout="output" Width="20" Parent="countdown_test" Color="#7fff00" Height="20" Y="0.481667" Side="right" Datatype="wire"/>
 <Port Datasize="1" Function="" X="-0.0222222" Name="tx_done" Inout="input" Width="20" Parent="countdown_test" Color="#ffe4c4" Height="20" Y="0.65" Side="left" Datatype="reg"/>
 <Wire Datasize="1" From="countdown_test>rst_n" Name="countdown_test_rst_n" Parent="countdown_test" Datatype="wire" To="countdown_test#countdown1>rst_n"/>
 <Wire Datasize="1" From="countdown_test>count_en" Name="countdown_test_count_en" Parent="countdown_test" Datatype="wire" To="countdown_test#countdown1>count_en"/>
 <Wire Datasize="1" From="countdown_test#countdown1>count_full" Name="countdown1_count_full" Parent="countdown_test" Datatype="wire" To="countdown_test>count_full"/>
 <Wire Datasize="8" From="countdown_test#countdown1>count_out" Name="countdown1_count_out" Parent="countdown_test" Datatype="wire" To="countdown_test>count_out"/>
 <Wire Datasize="1" From="countdown_test>tx_done" Name="countdown_test_tx_done" Parent="countdown_test" Datatype="wire" To="countdown_test#countdown1>tx_done"/>
 <Wire Datasize="1" From="countdown_test>clk" Name="countdown_test_clk" Parent="countdown_test" Datatype="wire" To="countdown_test#countdown1>clk"/>
</Module>
