<!DOCTYPE Robei>
<Module File="Current/uart_top_test.test" Height="600" Width="900" Color="#d3d3d3" Parent="0" Name="uart_top_test" X="0" Type="testbench" Class="module" Time_Scale="" Y="0" Comment="" Code="//&#xa;// Generate clk&#xa;//&#xa;initial begin &#xa;  clk = 0;&#xa;end&#xa;always #10 clk = ~clk;&#xa;&#xa;&#xa;initial begin&#xa;  rst_n = 1;&#xa;  key_in = 4'b0000;&#xa;  count_enable = 0;&#xa;  rx = 1;&#xa;&#xa;  //&#xa;  // Generate reset signal&#xa;  //&#xa;  repeat(1) @( posedge clk ) #1;&#xa;  rst_n = 0;&#xa;  repeat(1) @( posedge clk ) #1;&#xa;  rst_n = 1;  &#xa;&#xa;  // &#xa;  // Generate key signal&#xa;  //&#xa;  key_in = 4'b0000;&#xa;  repeat(1000000) @( posedge clk ) #1;&#xa;  key_in = 4'b0001;&#xa;  repeat(1000000) @( posedge clk ) #1;&#xa;  key_in = 4'b0010;&#xa;  repeat(1000000) @( posedge clk ) #1;&#xa;  key_in = 4'b0100;&#xa;  repeat(1000000) @( posedge clk ) #1;&#xa;  key_in = 4'b1000;&#xa;  repeat(1000000) @( posedge clk ) #1;     &#xa;  key_in = 4'b0000;&#xa;  repeat(1000000) @( posedge clk ) #1;   &#xa;&#xa;  //&#xa;  // Generate countdown signals&#xa;  //&#xa;  count_enable = 0;&#xa;  repeat( 4 ) @( posedge clk ) #1;&#xa;  count_enable = 1;&#xa;  repeat( 2 ) @( posedge clk ) #1;&#xa;  count_enable= 0;&#xa;  repeat( 50 ) @( posedge clk ) #1;&#xa;  count_enable = 1;&#xa;  repeat( 2 ) @( posedge clk ) #1;&#xa;  count_enable= 0;&#xa;  repeat( 50000 ) @( posedge clk ) #1;&#xa;&#xa;  //**************************************************************************//&#xa;  // Generate led display signals.&#xa;  //&#xa;  // Attension: There should be two datas in once send, the first data is used&#xa;  // to display, while the second one is set to 0( all datas are 8 bits ).&#xa;  // Because we had integretd the display module and the division_duty module&#xa;  // together, if you only send the data once, it will cause the division_duty&#xa;  // output error.&#xa;  //&#xa;  // Please pay attention!!!&#xa;  //**************************************************************************//&#xa;  &#xa;  // &#xa;  // The display data&#xa;  //&#xa;  rx = 1;&#xa;  repeat(10)@( posedge clk ) #1; &#xa;  &#xa;  // Receive display data, which is 1_1001_1011_0( 155 )&#xa;  //&#xa;  repeat(32)@( posedge clk ) #1;&#xa;  rx = 0;  // Start signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;  // Least significant signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0; &#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;  // Most significant signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;  // Parity check&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;  // Stop bit   &#xa;  repeat(16)@( posedge clk ) #1;&#xa;&#xa;  rx = 1;&#xa;  repeat(10)@( posedge clk ) #1; &#xa;  &#xa;  // Receive 0, which is 0_0000_0000_0&#xa;  //&#xa;  repeat(32)@( posedge clk ) #1;&#xa;  rx = 0;  // Start signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;  // Least significant signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0; &#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;  // Most significant signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;  // Parity check&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;  // Stop bit   &#xa;  repeat(16)@( posedge clk ) #1;&#xa;&#xa;  //&#xa;  // Uart division_duty testbench&#xa;  //&#xa;  rx = 1;&#xa;  repeat(10)@( posedge clk ) #1; &#xa;  //&#xa;  // Receive division data, division is 0_0001_0100_0( 20 )&#xa;  //&#xa;  repeat(32)@( posedge clk ) #1;&#xa;  rx = 0;  // Start signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;  // Least significant signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;  // Most significant signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;  // Parity check&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;  // Stop bit   &#xa;  repeat(16)@( posedge clk ) #1; &#xa;  rx = 1;   &#xa;  repeat(32)@( posedge clk ) #1; &#xa;&#xa;  //&#xa;  // Receive duty_num data, duty_num is 1_0000_1000_0( 8 )&#xa;  //&#xa;  rx = 1;&#xa;  repeat(32)@( posedge clk ) #1;&#xa;  rx = 0;  // Start signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;  // Least significant signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 0;  // Most significant signal&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;  // Parity check&#xa;  repeat(16)@( posedge clk ) #1;&#xa;  rx = 1;  // Stop bit   &#xa;  repeat(300)@( posedge clk ) #1;&#xa;&#xa;  $finish;&#xa;end" Include="">
 <Module File="Current/uart_top.model" Height="228" Width="215" Color="#d3d3d3" Parent="uart_top_test" Name="uart_top1" X="290.012" Type="model" Class="uart_top" Y="143.543" Comment="" Parameters="" Code="`define DEL 1&#xa;&#xa;wire [7:0] key_out;&#xa;wire [7:0] count_out;&#xa;wire       key_pressed;&#xa;wire       count_full;&#xa;&#xa;reg  [7:0] data_send;&#xa;reg        tx_en;&#xa;&#xa;always @( posedge clk or negedge rst_n ) begin&#xa;  if( ~rst_n ) begin&#xa;    data_send &lt;= #`DEL 8'd0;&#xa;  end&#xa;  else if( key_pressed ) begin&#xa;    data_send &lt;= #`DEL key_out;&#xa;  end&#xa;  else if( count_full ) begin&#xa;    data_send &lt;= #`DEL count_out;&#xa;  end&#xa;end   &#xa;&#xa;always @( posedge clk or negedge rst_n ) begin&#xa;  if( ~rst_n ) begin&#xa;    tx_en     &lt;= #`DEL 1'd0;&#xa;  end&#xa;  else begin&#xa;    tx_en     &lt;= #`DEL key_pressed || count_full;&#xa;  end&#xa;end    &#xa;" Include="">
  <Port Height="20" Function="" Width="20" Color="#0000ff" Parent="uart_top1" Name="clk" X="-0.0930233" Side="left" Y="0.0964912" Connect="" Inout="input" Datatype="wire" Datasize="1"/>
  <Port Height="20" Function="" Width="20" Color="#00ffff" Parent="uart_top1" Name="rst_n" X="-0.0930233" Side="left" Y="0.236842" Connect="" Inout="input" Datatype="wire" Datasize="1"/>
  <Port Height="20" Function="" Width="20" Color="#7fffd4" Parent="uart_top1" Name="key_in" X="-0.0930233" Side="left" Y="0.377193" Connect="" Inout="input" Datatype="wire" Datasize="4"/>
  <Port Height="20" Function="" Width="20" Color="#bdb76b" Parent="uart_top1" Name="tx" X="0.906977" Side="right" Y="0.236842" Connect="" Inout="output" Datatype="wire" Datasize="1"/>
  <Port Height="20" Function="" Width="20" Color="#556b2f" Parent="uart_top1" Name="count_enable" X="-0.0930233" Side="left" Y="0.657895" Connect="" Inout="input" Datatype="wire" Datasize="1"/>
  <Port Height="20" Function="" Width="20" Color="#ffe4c4" Parent="uart_top1" Name="tx_buf_full" X="0.906977" Side="right" Y="0.0964912" Connect="" Inout="output" Datatype="wire" Datasize="1"/>
  <Port Height="20" Function="" Width="20" Color="#b8860b" Parent="uart_top1" Name="rx" X="-0.0930233" Side="left" Y="0.517544" Connect="" Inout="input" Datatype="wire" Datasize="1"/>
  <Port Height="20" Function="" Width="20" Color="#1e90ff" Parent="uart_top1" Name="led0_out" X="0.906977" Side="right" Y="0.657895" Connect="" Inout="output" Datatype="wire" Datasize="4"/>
  <Port Height="20" Function="" Width="20" Color="#8b0000" Parent="uart_top1" Name="led1_out" X="0.906977" Side="right" Y="0.517544" Connect="" Inout="output" Datatype="wire" Datasize="4"/>
  <Port Height="20" Function="" Width="20" Color="#8a2be2" Parent="uart_top1" Name="clk_out" X="0.906977" Side="right" Y="0.377193" Connect="" Inout="output" Datatype="wire" Datasize="1"/>
 </Module>
 <Port Height="20" Function="" Width="20" Color="#0000ff" Parent="uart_top_test" Name="clk" X="-0.0222222" Side="left" Y="0.125" Inout="input" Datatype="reg" Datasize="1"/>
 <Port Height="20" Function="" Width="20" Color="#00ffff" Parent="uart_top_test" Name="rst_n" X="-0.0222222" Side="left" Y="0.266667" Inout="input" Datatype="reg" Datasize="1"/>
 <Port Height="20" Function="" Width="20" Color="#7fffd4" Parent="uart_top_test" Name="key_in" X="-0.0222222" Side="left" Y="0.408333" Inout="input" Datatype="reg" Datasize="4"/>
 <Port Height="20" Function="" Width="20" Color="#bdb76b" Parent="uart_top_test" Name="tx" X="0.977778" Side="right" Y="0.125" Inout="output" Datatype="wire" Datasize="1"/>
 <Port Height="20" Function="" Width="20" Color="#556b2f" Parent="uart_top_test" Name="count_enable" X="-0.0222222" Side="left" Y="0.55" Inout="input" Datatype="reg" Datasize="1"/>
 <Port Height="20" Function="" Width="20" Color="#ffe4c4" Parent="uart_top_test" Name="tx_buf_full" X="0.977778" Side="right" Y="0.266667" Inout="output" Datatype="wire" Datasize="1"/>
 <Port Height="20" Function="" Width="20" Color="#b8860b" Parent="uart_top_test" Name="rx" X="-0.0222222" Side="left" Y="0.691667" Inout="input" Datatype="reg" Datasize="1"/>
 <Port Height="20" Function="" Width="20" Color="#1e90ff" Parent="uart_top_test" Name="led0_out" X="0.977778" Side="right" Y="0.408333" Inout="output" Datatype="wire" Datasize="4"/>
 <Port Height="20" Function="" Width="20" Color="#8b0000" Parent="uart_top_test" Name="led1_out" X="0.977778" Side="right" Y="0.55" Inout="output" Datatype="wire" Datasize="4"/>
 <Port Height="20" Function="" Width="20" Color="#8a2be2" Parent="uart_top_test" Name="clk_out" X="0.977778" Side="right" Y="0.691667" Inout="output" Datatype="wire" Datasize="1"/>
 <Wire From="uart_top_test>clk" Parent="uart_top_test" Name="uart_top_test_clk" To="uart_top_test#uart_top1>clk" Datatype="wire" Datasize="1"/>
 <Wire From="uart_top_test>rst_n" Parent="uart_top_test" Name="uart_top_test_rst_n" To="uart_top_test#uart_top1>rst_n" Datatype="wire" Datasize="1"/>
 <Wire From="uart_top_test>key_in" Parent="uart_top_test" Name="uart_top_test_key_in" To="uart_top_test#uart_top1>key_in" Datatype="wire" Datasize="4"/>
 <Wire From="uart_top_test>count_enable" Parent="uart_top_test" Name="uart_top_test_count_enable" To="uart_top_test#uart_top1>count_enable" Datatype="wire" Datasize="1"/>
 <Wire From="uart_top_test>rx" Parent="uart_top_test" Name="uart_top_test_rx" To="uart_top_test#uart_top1>rx" Datatype="wire" Datasize="1"/>
 <Wire From="uart_top_test#uart_top1>tx_buf_full" Parent="uart_top_test" Name="uart_top1_tx_buf_full" To="uart_top_test>tx_buf_full" Datatype="wire" Datasize="1"/>
 <Wire From="uart_top_test#uart_top1>tx" Parent="uart_top_test" Name="uart_top1_tx" To="uart_top_test>tx" Datatype="wire" Datasize="1"/>
 <Wire From="uart_top_test#uart_top1>clk_out" Parent="uart_top_test" Name="uart_top1_clk_out" To="uart_top_test>clk_out" Datatype="wire" Datasize="1"/>
 <Wire From="uart_top_test#uart_top1>led1_out" Parent="uart_top_test" Name="uart_top1_led1_out" To="uart_top_test>led1_out" Datatype="wire" Datasize="4"/>
 <Wire From="uart_top_test#uart_top1>led0_out" Parent="uart_top_test" Name="uart_top1_led0_out" To="uart_top_test>led0_out" Datatype="wire" Datasize="4"/>
</Module>
